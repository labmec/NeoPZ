

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Electromagnetics Group &mdash; NeoPZ  documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/graphviz.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> NeoPZ
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="materialindex.html">The Material hierarchy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../structmatrix/structindex.html">The StructMatrix hierarchy</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">NeoPZ</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Electromagnetics Group</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/material/electromagnetics.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="electromagnetics-group">
<h1>Electromagnetics Group<a class="headerlink" href="#electromagnetics-group" title="Permalink to this headline">¶</a></h1>
<div class="toctree-wrapper compound">
</div>
<div class="contents local topic" id="table-of-contents">
<p class="topic-title">Table of Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#modal-analysis-of-waveguides" id="id3">Modal Analysis of Waveguides</a></p>
<ul>
<li><p><a class="reference internal" href="#tpzwaveguidemodalanalysis" id="id4">TPZWaveguideModalAnalysis</a></p></li>
<li><p><a class="reference internal" href="#tpzwaveguidemodalanalysispml" id="id5">TPZWaveguideModalAnalysisPML</a></p></li>
</ul>
</li>
</ul>
</div>
<p>This group has materials related to electromagnetic problems.</p>
<div class="section" id="modal-analysis-of-waveguides">
<h2><a class="toc-backref" href="#id3">Modal Analysis of Waveguides</a><a class="headerlink" href="#modal-analysis-of-waveguides" title="Permalink to this headline">¶</a></h2>
<p>The following classes implement a <span class="math notranslate nohighlight">\(H(\text{curl},\Omega)\times H^1(\Omega)\)</span> formulation for the analysis of waveguides. More precisely, they implement:</p>
<p>Find non-trivial <span class="math notranslate nohighlight">\(\left(\beta^2,{e_t}, {e_z}\right) \in (\mathbb{C} \times [\mathbb{C}]^N \times [\mathbb{C}]^M)\)</span> such that:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{bmatrix}
A_{tt} &amp; 0 \\
0      &amp; 0
\end{bmatrix}
\begin{Bmatrix}
e_t \\
e_z
\end{Bmatrix}
= - \beta ^2
\begin{bmatrix}
B_{tt} &amp; B_{tz} \\
B_{zt} &amp; B_{zz}
\end{bmatrix}
\begin{Bmatrix}
e_t \\
e_z
\end{Bmatrix}
\text{,}\end{split}\]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[\begin{split}[A_{tt}]_{ij} &amp;= \int_{\Omega}
\left[
\mu_{zz}^{-1}\left( \nabla_t\times \boldsymbol{\varphi}_i \right) \cdot
\left( \nabla_t\times \boldsymbol{\varphi}_j \right)
- k_0^2 \boldsymbol{\epsilon}_{xy} \boldsymbol{\varphi}_i\cdot \boldsymbol{\varphi}_j\right] d\Omega\text{,}\label{eq:fem-mat-1}\\
  [B_{tt}]_{ij} &amp;= \int_{\Omega}  \boldsymbol{\mu}_{xy^S}^{-1}\boldsymbol{\varphi}_i  \cdot
  \boldsymbol{\varphi}_j\, d\Omega\text{,}\label{eq:fem-mat-2}\\
  [B_{tz}]_{ij} &amp;= \int_{\Omega}  \boldsymbol{\mu}_{xy^S}^{-1}\boldsymbol{\varphi}_i  \cdot
  \nabla_t\, \varphi_j\, d\Omega\text{,}\label{eq:fem-mat-3}\\
  [B_{zt}]_{ij} &amp;= \int_{\Omega}  \boldsymbol{\mu}_{xy^S}^{-1}\nabla_t\, \varphi_i  \cdot
  \boldsymbol{\varphi}_j
  \, d\Omega\text{,}\label{eq:fem-mat-4}\\
  [B_{zz}]_{ij} &amp;= \int_{\Omega}
  \left[
  \boldsymbol{\mu}_r^{-1}\nabla_t\, \varphi_i  \cdot
  \nabla_t\, \varphi_j
  - k_0^2 \epsilon_{zz} \varphi_i \varphi_j\right] d\Omega\text{.}\label{eq:fem-mat-5}\end{split}\]</div>
<p>This formulation was presented originally in this work <a class="footnote-reference brackets" href="#lee1991" id="id1">1</a>. In this work <a class="footnote-reference brackets" href="#orlandini2018" id="id2">2</a> a very detailed derivation along with results obtained using NeoPZ are presented.</p>
<div class="section" id="tpzwaveguidemodalanalysis">
<h3><a class="toc-backref" href="#id4">TPZWaveguideModalAnalysis</a><a class="headerlink" href="#tpzwaveguidemodalanalysis" title="Permalink to this headline">¶</a></h3>
<p>This class supports materials with the following form of anisotropy:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\epsilon_r =
\begin{bmatrix}
\epsilon_{xx} &amp; 0 &amp; 0\\
0 &amp; \epsilon_{yy}  &amp; 0\\
0 &amp; 0 &amp; \epsilon_{zz}\\
\end{bmatrix}\,\,\,\,\,
\mu_r =
\begin{bmatrix}
\mu_{xx} &amp; 0 &amp; 0\\
0 &amp; \mu_{yy}  &amp; 0\\
0 &amp; 0 &amp; \mu_{zz}\\
\end{bmatrix}\end{split}\]</div>
<dl class="cpp class">
<dt class="sig sig-object cpp" id="_CPPv425TPZWaveguideModalAnalysis">
<span id="_CPPv325TPZWaveguideModalAnalysis"></span><span id="_CPPv225TPZWaveguideModalAnalysis"></span><span id="TPZWaveguideModalAnalysis"></span><span class="target" id="classTPZWaveguideModalAnalysis"></span><span class="k"><span class="pre">class</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">TPZWaveguideModalAnalysis</span></span></span><span class="w"> </span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="k"><span class="pre">public</span></span><span class="w"> </span><a class="reference internal" href="materialindex.html#_CPPv4I0DpE10TPZMatBase" title="TPZMatBase"><span class="n"><span class="pre">TPZMatBase</span></span></a><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">CSTATE</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="combinedspaces.html#_CPPv4I0E21TPZMatCombinedSpacesT" title="TPZMatCombinedSpacesT"><span class="n"><span class="pre">TPZMatCombinedSpacesT</span></span></a><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">CSTATE</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><a class="reference internal" href="combinedspaces.html#_CPPv425TPZMatGeneralisedEigenVal" title="TPZMatGeneralisedEigenVal"><span class="n"><span class="pre">TPZMatGeneralisedEigenVal</span></span></a><span class="p"><span class="pre">&gt;</span></span><br /></dt>
<dd><p>This class implements the weak statement for the modal analysis of waveguides using HCurl and H1 elements. It uses a 2D Hcurl space for the transversal components of the electric field and an 1D H1 space for the longitudinal component. </p>
<p><div class="admonition note">
<p class="admonition-title">Note</p>
<p>Formulation taken from: LEE, J.-F.; SUN, D.-K.; CENDES, Z.J. Full-wave analysis of dielectric waveguides usingtangential vector finite elements.IEEE Transactions on Microwave Theory and Techniques, Institute of Electrical and Electronics Engineers (IEEE), v. 39, n. 8,p. 1262–1271, 1991 </p>
</div>
</p>
<p>Subclassed by <a class="reference internal" href="#classTPZWaveguideModalAnalysisPML"><span class="std std-ref">TPZWaveguideModalAnalysisPML</span></a></p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-internalgeneralisedattributes">InternalGeneralisedAttributes</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N25TPZWaveguideModalAnalysis18fCurrentContributeE">
<span id="_CPPv3N25TPZWaveguideModalAnalysis18fCurrentContributeE"></span><span id="_CPPv2N25TPZWaveguideModalAnalysis18fCurrentContributeE"></span><span id="TPZWaveguideModalAnalysis::fCurrentContribute__TContributeType"></span><span class="target" id="classTPZWaveguideModalAnalysis_1a93808fcd02ec8cc166c4c3cc496fe50e"></span><span class="n"><span class="pre">TContributeType</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">fCurrentContribute</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="p"><span class="pre">{</span></span><span class="k"><span class="pre">nullptr</span></span><span class="p"><span class="pre">}</span></span><br /></dt>
<dd><p>Pointer to the current Contribute function. </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N25TPZWaveguideModalAnalysis20fCurrentContributeBCE">
<span id="_CPPv3N25TPZWaveguideModalAnalysis20fCurrentContributeBCE"></span><span id="_CPPv2N25TPZWaveguideModalAnalysis20fCurrentContributeBCE"></span><span id="TPZWaveguideModalAnalysis::fCurrentContributeBC__TContributeBCType"></span><span class="target" id="classTPZWaveguideModalAnalysis_1acd17ce3573fafc2f561fd60681e48898"></span><span class="n"><span class="pre">TContributeBCType</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">fCurrentContributeBC</span></span></span><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="p"><span class="pre">{</span></span><span class="k"><span class="pre">nullptr</span></span><span class="p"><span class="pre">}</span></span><br /></dt>
<dd><p>Pointer to the current ContributeBC function. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-solutionmethods">SolutionMethods</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK25TPZWaveguideModalAnalysis13VariableIndexERKNSt6stringE">
<span id="_CPPv3NK25TPZWaveguideModalAnalysis13VariableIndexERKNSt6stringE"></span><span id="_CPPv2NK25TPZWaveguideModalAnalysis13VariableIndexERKNSt6stringE"></span><span id="TPZWaveguideModalAnalysis::VariableIndex__ssCRC"></span><span class="target" id="classTPZWaveguideModalAnalysis_1a1fc199241397c46faa6bdfa8d5546ab7"></span><span class="k"><span class="pre">virtual</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">VariableIndex</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">string</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">name</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">override</span></span><br /></dt>
<dd><p>Variable index of a given solution. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK25TPZWaveguideModalAnalysis18NSolutionVariablesEi">
<span id="_CPPv3NK25TPZWaveguideModalAnalysis18NSolutionVariablesEi"></span><span id="_CPPv2NK25TPZWaveguideModalAnalysis18NSolutionVariablesEi"></span><span id="TPZWaveguideModalAnalysis::NSolutionVariables__iC"></span><span class="target" id="classTPZWaveguideModalAnalysis_1a90942160bb94082136e925fddde15283"></span><span class="k"><span class="pre">virtual</span></span><span class="w"> </span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">NSolutionVariables</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">var</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">override</span></span><br /></dt>
<dd><p>Number of variables associated with a given solution. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N25TPZWaveguideModalAnalysis8SolutionERK6TPZVecI16TPZMaterialDataTI6CSTATEEEiR6TPZVecI6CSTATEE">
<span id="_CPPv3N25TPZWaveguideModalAnalysis8SolutionERK6TPZVecI16TPZMaterialDataTI6CSTATEEEiR6TPZVecI6CSTATEE"></span><span id="_CPPv2N25TPZWaveguideModalAnalysis8SolutionERK6TPZVecI16TPZMaterialDataTI6CSTATEEEiR6TPZVecI6CSTATEE"></span><span id="TPZWaveguideModalAnalysis::Solution__TPZVec:TPZMaterialDataT:CSTATE::CR.i.TPZVec:CSTATE:R"></span><span class="target" id="classTPZWaveguideModalAnalysis_1acbf6a4802f73e76acf57d77c727d8cb0"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Solution</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">TPZVec</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="materialindex.html#_CPPv4I0E16TPZMaterialDataT" title="TPZMaterialDataT"><span class="n"><span class="pre">TPZMaterialDataT</span></span></a><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">CSTATE</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">datavec</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">var</span></span>, <span class="n"><span class="pre">TPZVec</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">CSTATE</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">solout</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">override</span></span><br /></dt>
<dd><p>Computes the solution at an integration point. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK25TPZWaveguideModalAnalysis5GetKzEv">
<span id="_CPPv3NK25TPZWaveguideModalAnalysis5GetKzEv"></span><span id="_CPPv2NK25TPZWaveguideModalAnalysis5GetKzEv"></span><span id="TPZWaveguideModalAnalysis::GetKzC"></span><span class="target" id="classTPZWaveguideModalAnalysis_1accf4350def34958d2dfbb34587483b2f"></span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">CSTATE</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="sig-name descname"><span class="n"><span class="pre">GetKz</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><br /></dt>
<dd><p>Get the propagation constant used for post processing the solution. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N25TPZWaveguideModalAnalysis5SetKzERK5STATE">
<span id="_CPPv3N25TPZWaveguideModalAnalysis5SetKzERK5STATE"></span><span id="_CPPv2N25TPZWaveguideModalAnalysis5SetKzERK5STATE"></span><span id="TPZWaveguideModalAnalysis::SetKz__STATECR"></span><span class="target" id="classTPZWaveguideModalAnalysis_1a9afb531c47b7847f2bbe0ae629023d94"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">SetKz</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">STATE</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">kz</span></span><span class="sig-paren">)</span><br /></dt>
<dd><p>Set the propagation constant used for post processing the solution. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK25TPZWaveguideModalAnalysis24ShouldPrintFieldRealPartEv">
<span id="_CPPv3NK25TPZWaveguideModalAnalysis24ShouldPrintFieldRealPartEv"></span><span id="_CPPv2NK25TPZWaveguideModalAnalysis24ShouldPrintFieldRealPartEv"></span><span id="TPZWaveguideModalAnalysis::ShouldPrintFieldRealPartC"></span><span class="target" id="classTPZWaveguideModalAnalysis_1a0a5ce8535df98b06ab177e23d7fc7de0"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ShouldPrintFieldRealPart</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><br /></dt>
<dd><p>Whether to print only the real part of the electromagnetic field. If false, it prints the magnitude of the field. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N25TPZWaveguideModalAnalysis21SetPrintFieldRealPartEb">
<span id="_CPPv3N25TPZWaveguideModalAnalysis21SetPrintFieldRealPartEb"></span><span id="_CPPv2N25TPZWaveguideModalAnalysis21SetPrintFieldRealPartEb"></span><span id="TPZWaveguideModalAnalysis::SetPrintFieldRealPart__b"></span><span class="target" id="classTPZWaveguideModalAnalysis_1a8915b5f2535b406a816345ca8b842263"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">SetPrintFieldRealPart</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">bool</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">printFieldRealPart</span></span><span class="sig-paren">)</span><br /></dt>
<dd><p>Set to print only the real part of the electromagnetic field. If set to false, it prints the magnitude of the field. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-generalisedmethods">GeneralisedMethods</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N25TPZWaveguideModalAnalysis10SetMatrixAEv">
<span id="_CPPv3N25TPZWaveguideModalAnalysis10SetMatrixAEv"></span><span id="_CPPv2N25TPZWaveguideModalAnalysis10SetMatrixAEv"></span><span id="TPZWaveguideModalAnalysis::SetMatrixA"></span><span class="target" id="classTPZWaveguideModalAnalysis_1ae380c1a49a7befe34dc868c5d0c61eb8"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">SetMatrixA</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">override</span></span><br /></dt>
<dd><p>Set the material to compute matrix A. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N25TPZWaveguideModalAnalysis10SetMatrixBEv">
<span id="_CPPv3N25TPZWaveguideModalAnalysis10SetMatrixBEv"></span><span id="_CPPv2N25TPZWaveguideModalAnalysis10SetMatrixBEv"></span><span id="TPZWaveguideModalAnalysis::SetMatrixB"></span><span class="target" id="classTPZWaveguideModalAnalysis_1a12b63f6c581ae8aebbdbe9db2c33c58c"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">SetMatrixB</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">override</span></span><br /></dt>
<dd><p>Set the material to compute matrix B. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-internalcontributemethods">InternalContributeMethods</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N25TPZWaveguideModalAnalysis11ContributeAERK6TPZVecI16TPZMaterialDataTI6CSTATEEE4REALR10TPZFMatrixI6CSTATEER10TPZFMatrixI6CSTATEE">
<span id="_CPPv3N25TPZWaveguideModalAnalysis11ContributeAERK6TPZVecI16TPZMaterialDataTI6CSTATEEE4REALR10TPZFMatrixI6CSTATEER10TPZFMatrixI6CSTATEE"></span><span id="_CPPv2N25TPZWaveguideModalAnalysis11ContributeAERK6TPZVecI16TPZMaterialDataTI6CSTATEEE4REALR10TPZFMatrixI6CSTATEER10TPZFMatrixI6CSTATEE"></span><span id="TPZWaveguideModalAnalysis::ContributeA__TPZVec:TPZMaterialDataT:CSTATE::CR.REAL.TPZFMatrix:CSTATE:R.TPZFMatrix:CSTATE:R"></span><span class="target" id="classTPZWaveguideModalAnalysis_1ae9a740e3bf3eb4aee23f5930b5d941d4"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ContributeA</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">TPZVec</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="materialindex.html#_CPPv4I0E16TPZMaterialDataT" title="TPZMaterialDataT"><span class="n"><span class="pre">TPZMaterialDataT</span></span></a><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">CSTATE</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">datavec</span></span>, <span class="n"><span class="pre">REAL</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">weight</span></span>, <span class="n"><span class="pre">TPZFMatrix</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">CSTATE</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">ek</span></span>, <span class="n"><span class="pre">TPZFMatrix</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">CSTATE</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">ef</span></span><span class="sig-paren">)</span><br /></dt>
<dd><p>Contribution of the A Matrix. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N25TPZWaveguideModalAnalysis13ContributeBCAERK6TPZVecI16TPZMaterialDataTI6CSTATEEE4REALR10TPZFMatrixI6CSTATEER10TPZFMatrixI6CSTATEER11TPZBndCondTI6CSTATEE">
<span id="_CPPv3N25TPZWaveguideModalAnalysis13ContributeBCAERK6TPZVecI16TPZMaterialDataTI6CSTATEEE4REALR10TPZFMatrixI6CSTATEER10TPZFMatrixI6CSTATEER11TPZBndCondTI6CSTATEE"></span><span id="_CPPv2N25TPZWaveguideModalAnalysis13ContributeBCAERK6TPZVecI16TPZMaterialDataTI6CSTATEEE4REALR10TPZFMatrixI6CSTATEER10TPZFMatrixI6CSTATEER11TPZBndCondTI6CSTATEE"></span><span id="TPZWaveguideModalAnalysis::ContributeBCA__TPZVec:TPZMaterialDataT:CSTATE::CR.REAL.TPZFMatrix:CSTATE:R.TPZFMatrix:CSTATE:R.TPZBndCondT:CSTATE:R"></span><span class="target" id="classTPZWaveguideModalAnalysis_1a8aacb20f10a05f7d87c6e3f8dbb0ce04"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ContributeBCA</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">TPZVec</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="materialindex.html#_CPPv4I0E16TPZMaterialDataT" title="TPZMaterialDataT"><span class="n"><span class="pre">TPZMaterialDataT</span></span></a><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">CSTATE</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">datavec</span></span>, <span class="n"><span class="pre">REAL</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">weight</span></span>, <span class="n"><span class="pre">TPZFMatrix</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">CSTATE</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">ek</span></span>, <span class="n"><span class="pre">TPZFMatrix</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">CSTATE</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">ef</span></span>, <a class="reference internal" href="materialindex.html#_CPPv4I0E11TPZBndCondT" title="TPZBndCondT"><span class="n"><span class="pre">TPZBndCondT</span></span></a><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">CSTATE</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">bc</span></span><span class="sig-paren">)</span><br /></dt>
<dd><p>Boundary contribution of the A Matrix. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N25TPZWaveguideModalAnalysis11ContributeBERK6TPZVecI16TPZMaterialDataTI6CSTATEEE4REALR10TPZFMatrixI6CSTATEER10TPZFMatrixI6CSTATEE">
<span id="_CPPv3N25TPZWaveguideModalAnalysis11ContributeBERK6TPZVecI16TPZMaterialDataTI6CSTATEEE4REALR10TPZFMatrixI6CSTATEER10TPZFMatrixI6CSTATEE"></span><span id="_CPPv2N25TPZWaveguideModalAnalysis11ContributeBERK6TPZVecI16TPZMaterialDataTI6CSTATEEE4REALR10TPZFMatrixI6CSTATEER10TPZFMatrixI6CSTATEE"></span><span id="TPZWaveguideModalAnalysis::ContributeB__TPZVec:TPZMaterialDataT:CSTATE::CR.REAL.TPZFMatrix:CSTATE:R.TPZFMatrix:CSTATE:R"></span><span class="target" id="classTPZWaveguideModalAnalysis_1ade0670a0e19b72ad25c095ab9a8f407a"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ContributeB</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">TPZVec</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="materialindex.html#_CPPv4I0E16TPZMaterialDataT" title="TPZMaterialDataT"><span class="n"><span class="pre">TPZMaterialDataT</span></span></a><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">CSTATE</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">datavec</span></span>, <span class="n"><span class="pre">REAL</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">weight</span></span>, <span class="n"><span class="pre">TPZFMatrix</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">CSTATE</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">ek</span></span>, <span class="n"><span class="pre">TPZFMatrix</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">CSTATE</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">ef</span></span><span class="sig-paren">)</span><br /></dt>
<dd><p>Contribution of the B Matrix. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N25TPZWaveguideModalAnalysis13ContributeBCBERK6TPZVecI16TPZMaterialDataTI6CSTATEEE4REALR10TPZFMatrixI6CSTATEER10TPZFMatrixI6CSTATEER11TPZBndCondTI6CSTATEE">
<span id="_CPPv3N25TPZWaveguideModalAnalysis13ContributeBCBERK6TPZVecI16TPZMaterialDataTI6CSTATEEE4REALR10TPZFMatrixI6CSTATEER10TPZFMatrixI6CSTATEER11TPZBndCondTI6CSTATEE"></span><span id="_CPPv2N25TPZWaveguideModalAnalysis13ContributeBCBERK6TPZVecI16TPZMaterialDataTI6CSTATEEE4REALR10TPZFMatrixI6CSTATEER10TPZFMatrixI6CSTATEER11TPZBndCondTI6CSTATEE"></span><span id="TPZWaveguideModalAnalysis::ContributeBCB__TPZVec:TPZMaterialDataT:CSTATE::CR.REAL.TPZFMatrix:CSTATE:R.TPZFMatrix:CSTATE:R.TPZBndCondT:CSTATE:R"></span><span class="target" id="classTPZWaveguideModalAnalysis_1aa3d4527b59d62febbfc91274d1d7a99f"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">ContributeBCB</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">TPZVec</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="materialindex.html#_CPPv4I0E16TPZMaterialDataT" title="TPZMaterialDataT"><span class="n"><span class="pre">TPZMaterialDataT</span></span></a><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">CSTATE</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">datavec</span></span>, <span class="n"><span class="pre">REAL</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">weight</span></span>, <span class="n"><span class="pre">TPZFMatrix</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">CSTATE</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">ek</span></span>, <span class="n"><span class="pre">TPZFMatrix</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">CSTATE</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">ef</span></span>, <a class="reference internal" href="materialindex.html#_CPPv4I0E11TPZBndCondT" title="TPZBndCondT"><span class="n"><span class="pre">TPZBndCondT</span></span></a><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">CSTATE</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">bc</span></span><span class="sig-paren">)</span><br /></dt>
<dd><p>Boundary contribution of the B Matrix. </p>
</dd></dl>

</div>
</dd></dl>

<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The methods <span class="cpp-expr sig sig-inline cpp"><a class="reference internal" href="availablemats.html#_CPPv425TPZWaveguideModalAnalysis" title="TPZWaveguideModalAnalysis"><span class="n">TPZWaveguideModalAnalysis</span></a><span class="p">::</span><a class="reference internal" href="availablemats.html#_CPPv4N25TPZWaveguideModalAnalysis10SetMatrixAEv" title="TPZWaveguideModalAnalysis::SetMatrixA"><span class="n">SetMatrixA</span></a></span> and <span class="cpp-expr sig sig-inline cpp"><a class="reference internal" href="availablemats.html#_CPPv425TPZWaveguideModalAnalysis" title="TPZWaveguideModalAnalysis"><span class="n">TPZWaveguideModalAnalysis</span></a><span class="p">::</span><a class="reference internal" href="availablemats.html#_CPPv4N25TPZWaveguideModalAnalysis10SetMatrixBEv" title="TPZWaveguideModalAnalysis::SetMatrixB"><span class="n">SetMatrixB</span></a></span> are responsible for ensuring that the right call to the contribute method is done depending on which matrix is being assembled.</p>
</div>
</div>
<div class="section" id="tpzwaveguidemodalanalysispml">
<h3><a class="toc-backref" href="#id5">TPZWaveguideModalAnalysisPML</a><a class="headerlink" href="#tpzwaveguidemodalanalysispml" title="Permalink to this headline">¶</a></h3>
<p>This class implements a rectangular PML to be used with TPZWaveguideModalAnalysis.</p>
<dl class="cpp class">
<dt class="sig sig-object cpp" id="_CPPv428TPZWaveguideModalAnalysisPML">
<span id="_CPPv328TPZWaveguideModalAnalysisPML"></span><span id="_CPPv228TPZWaveguideModalAnalysisPML"></span><span id="TPZWaveguideModalAnalysisPML"></span><span class="target" id="classTPZWaveguideModalAnalysisPML"></span><span class="k"><span class="pre">class</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">TPZWaveguideModalAnalysisPML</span></span></span><span class="w"> </span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="k"><span class="pre">public</span></span><span class="w"> </span><a class="reference internal" href="availablemats.html#_CPPv425TPZWaveguideModalAnalysis" title="TPZWaveguideModalAnalysis"><span class="n"><span class="pre">TPZWaveguideModalAnalysis</span></span></a><br /></dt>
<dd><p>This class implements a rectangular PML for the <a class="reference internal" href="#classTPZWaveguideModalAnalysis"><span class="std std-ref">TPZWaveguideModalAnalysis</span></a> class. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-solutionmethods">SolutionMethods</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4N28TPZWaveguideModalAnalysisPML8SolutionERK6TPZVecI16TPZMaterialDataTI6CSTATEEEiR6TPZVecI6CSTATEE">
<span id="_CPPv3N28TPZWaveguideModalAnalysisPML8SolutionERK6TPZVecI16TPZMaterialDataTI6CSTATEEEiR6TPZVecI6CSTATEE"></span><span id="_CPPv2N28TPZWaveguideModalAnalysisPML8SolutionERK6TPZVecI16TPZMaterialDataTI6CSTATEEEiR6TPZVecI6CSTATEE"></span><span id="TPZWaveguideModalAnalysisPML::Solution__TPZVec:TPZMaterialDataT:CSTATE::CR.i.TPZVec:CSTATE:R"></span><span class="target" id="classTPZWaveguideModalAnalysisPML_1a0fa6456f1c55b651f1827f88edcabeee"></span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Solution</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">TPZVec</span></span><span class="p"><span class="pre">&lt;</span></span><a class="reference internal" href="materialindex.html#_CPPv4I0E16TPZMaterialDataT" title="TPZMaterialDataT"><span class="n"><span class="pre">TPZMaterialDataT</span></span></a><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">CSTATE</span></span><span class="p"><span class="pre">&gt;</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">datavec</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">var</span></span>, <span class="n"><span class="pre">TPZVec</span></span><span class="p"><span class="pre">&lt;</span></span><span class="n"><span class="pre">CSTATE</span></span><span class="p"><span class="pre">&gt;</span></span><span class="w"> </span><span class="p"><span class="pre">&amp;</span></span><span class="n sig-param"><span class="pre">solout</span></span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">override</span></span><br /></dt>
<dd><p>Computes the solution at an integration point. </p>
</dd></dl>

</div>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-functions">Public Functions</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK28TPZWaveguideModalAnalysisPML11NewMaterialEv">
<span id="_CPPv3NK28TPZWaveguideModalAnalysisPML11NewMaterialEv"></span><span id="_CPPv2NK28TPZWaveguideModalAnalysisPML11NewMaterialEv"></span><span id="TPZWaveguideModalAnalysisPML::NewMaterialC"></span><span class="target" id="classTPZWaveguideModalAnalysisPML_1a9fe9b01c387433c66ab19e552539da7c"></span><span class="k"><span class="pre">virtual</span></span><span class="w"> </span><a class="reference internal" href="availablemats.html#_CPPv428TPZWaveguideModalAnalysisPML" title="TPZWaveguideModalAnalysisPML"><span class="n"><span class="pre">TPZWaveguideModalAnalysisPML</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">NewMaterial</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">override</span></span><br /></dt>
<dd><p>To create another material of the same type. </p>
</dd></dl>

<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv4NK28TPZWaveguideModalAnalysisPML4NameEv">
<span id="_CPPv3NK28TPZWaveguideModalAnalysisPML4NameEv"></span><span id="_CPPv2NK28TPZWaveguideModalAnalysisPML4NameEv"></span><span id="TPZWaveguideModalAnalysisPML::NameC"></span><span class="target" id="classTPZWaveguideModalAnalysisPML_1a710884ab86c483a4612fbd75dab29d73"></span><span class="k"><span class="pre">inline</span></span><span class="w"> </span><span class="k"><span class="pre">virtual</span></span><span class="w"> </span><span class="n"><span class="pre">std</span></span><span class="p"><span class="pre">::</span></span><span class="n"><span class="pre">string</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">Name</span></span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><span class="w"> </span><span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="k"><span class="pre">override</span></span><br /></dt>
<dd><p>Returns the name of the material. </p>
</dd></dl>

</div>
</dd></dl>

<p><dl class="footnote brackets">
<dt class="label" id="lee1991"><span class="brackets"><a class="fn-backref" href="#id1">1</a></span></dt>
<dd><p>J.-F. Lee, D.-K. Sun, and Z.J. Cendes. Full-wave analysis of dielectric waveguides using tangential vector finite elements. <em>IEEE Transactions on Microwave Theory and Techniques</em>, 39(8):1262–1271, 1991.</p>
</dd>
<dt class="label" id="orlandini2018"><span class="brackets"><a class="fn-backref" href="#id2">2</a></span></dt>
<dd><p>Francisco T. Orlandini. A study on the construction of $H(curl,\Omega )$- elements and their application on waveguide problem. Master’s thesis, Universidade Estadual de Campinas, 2018.</p>
</dd>
</dl>
</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, Philippe Devloo et al.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>